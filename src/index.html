<!DOCTYPE html>
<html lang="en">
	//  test

<head>
<script type="text/javascript" src="https://cdn-prod.eu.securiti.ai/consent/auto_blocking/7b43eaa8-fa66-4a36-a2b8-dc115c2c49ac/d0af334e-187d-40e1-b0ce-b467a5838be0.js"></script>
<!-- Google Tag Manager -->
<!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NHMTCPH');</script>
<!-- End Google Tag Manager -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1QGG990DEL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1QGG990DEL');
</script>
<script>
window.addEventListener('message', function(ev) {
    console.log(ev)
 })
</script>  
  <script src="tracker.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <title>Cookie Consent JavaScript App</title>
  <link rel='stylesheet' type='text/css' href='https://cdn-prod.eu.securiti.ai/consent/cookie-consent.css' />
  <style>.cc-btn cc-allow{display:none;}</style>
</head>

<body>
<!-- Google Tag Manager (noscript) -->
<!-- <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NHMTCPH"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  <main>
    <h1>Cookie Consent App Hello</h1>
    <p>Loading content from the API: <b id="message">...</b></p> 
<iframe src="https://www.linkedin.com/embed/feed/update/urn:li:share:7001577026398654465" allowfullscreen="" title="Embedded post" width="1200" height="200" frameborder="0"></iframe>
<iframe src="https://privacy-central.eu.securiti.ai/dsr-embed/8be7d131-5bc9-47f9-a8d6-e8c6016f72f2?value=www.cookieconsentcxtest.tk" allowfullscreen="" title="Embedded post" width="1200" height="2000" frameborder="0"></iframe>
<script>
                    window.addEventListener('load', function() {
                    var codeGenMetadata = {
                        // todo: put form id here
                        formPropertyId: 2,
                        formSelector: '[DataElement*="DataElement"]',
                        subjectIdentifiers: [{"name":"Email","selector":"Email","isPrimary":true}],
                        consentIdentifiers: [{"type":"radio","name":"Recruitment","selector":"Recruitment","propertyId":2076,"consentValue":"Recruitment"}],
                        consentTrigger: {
                            action: 'submit',
                            selector: ''
                        }
                    };

                    var form, forms = document.querySelectorAll(codeGenMetadata.formSelector);
                    if (forms.length > 1) {
                        for (var i = 0; i < forms.length; i++) {
                            if (forms[i].querySelector(codeGenMetadata.consentTrigger.selector)) {
                                form = forms[i]
                                break;
                            }
                        }
                    } else {
                        form = forms[0];
                    }

                    if (!form) {
                        return;
                    }

                    var browserFingerPrint = ''
                    
                    if (typeof window !== 'undefined' && typeof define === 'function' && define.amd) {
                        //If require js used in website render fingerprint js using require into DOM
                        require(['https://cdnjs.cloudflare.com/ajax/libs/fingerprintjs2/2.1.0/fingerprint2.js'], function(Fingerprint2) {
                            window.Fingerprint2 = Fingerprint2;
                            onFingerprintLoad()
                        });
                    } else {
                        var s = document.createElement('script');
                        s.async = 1;
                        s.src = 'https://cdnjs.cloudflare.com/ajax/libs/fingerprintjs2/2.1.0/fingerprint2.js';
                        var parent_node = document.head || document.body;
                        parent_node.appendChild(s);
                        s.addEventListener('load', onFingerprintLoad)
                    }

                    function onFingerprintLoad() {
                        Fingerprint2.get(function(components) {
                            browserFingerPrint = Fingerprint2.x64hash128(components.map(function(pair) {
                                return pair.value
                            }).join(), 31)
                        })
                    }
                    var isConsentTaken = false
                    var prepareConsentPayload = function(formEle) {
                        if (!isConsentTaken) {
                            isConsentTaken = true
                            var payload = {
                                form_info: {
                                    subject_info: {}
                                },
                                consent_info: [],
                                browser_finger_print: browserFingerPrint,
                                policy_version: 1,
                                form_property_id: codeGenMetadata.formPropertyId,
                                uuid: '',
                                uuids: {}
                            }

                            if (codeGenMetadata.consentIdentifiers.length === 1 && codeGenMetadata.consentIdentifiers[0].name === 'DefaultElementId') {
                                payload.consent_info.push({
                                    granted: true,
                                    timestamp: parseInt(new Date().getTime() / 1000),
                                    property_id: parseInt(codeGenMetadata.consentIdentifiers[0].propertyId)
                                })
                            } else {
                                codeGenMetadata.consentIdentifiers.forEach(function(identifier) {
                                    payload.consent_info.push({
                                        granted: getGranted(identifier, formEle),
                                        timestamp: parseInt(new Date().getTime() / 1000),
                                        property_id: parseInt(identifier.propertyId)
                                    })
                                })
                            }

                            codeGenMetadata.subjectIdentifiers.forEach(function(identifier) {
                                payload.form_info.subject_info[identifier.name] = formEle.querySelector(identifier.selector) && formEle.querySelector(identifier.selector).value || ''
                                if (identifier.isPrimary) {
                                    payload.uuid = payload.form_info.subject_info[identifier.name] || ''
                                    payload.uuids[identifier.name] = payload.form_info.subject_info[identifier.name] || ''
                                }
                            })
                            return payload
                        }
                    }

                    function getGranted(identifier, formEle) {
                        if (identifier.type == 'checkbox') {
                            var checkboxElement = formEle.querySelector(identifier.selector);
                            var parent = checkboxElement && checkboxElement.parentNode;
                            if (parent && parent.tagName === 'LABEL' && parent.offsetHeight === 0) {
                                parent = parent.parentNode
                            }
                            if (parent && parent.offsetHeight > 0) {
                                return identifier.consentValue === 'checked' ? checkboxElement.checked : !checkboxElement.checked;
                            }
                            return false;
                        } else {
                            var radioElements = formEle.querySelectorAll(identifier.selector);
                            var parent = radioElements[0] && radioElements[0].parentNode;
                            if (parent && parent.tagName === 'LABEL' && parent.offsetHeight === 0) {
                                parent = parent.parentNode
                            }
                            if (parent && parent.offsetHeight > 0) {
                                return identifier.consentValue === Array.prototype.slice.call(radioElements).filter(function(r) { return r.checked })[0].value;
                            }
                            return false;
                        }
                    }

                    function postConsentedItems(consentedItem) {
                        var xhr = new XMLHttpRequest();
                        xhr.open('POST', 'https://app.eu.securiti.ai/privaci/v1/consent/form/singleupload', false);
                        xhr.setRequestHeader('Content-type', 'application/json');
                        xhr.setRequestHeader('X-Auth-Token', 'b231175d-48a8-41a4-85c2-441d3617ae48');
                        xhr.setRequestHeader('X-ORG-ID', '1');

                        xhr.onload = function () {
                            if (this.status >= 200 && this.status < 300) {
                                var resp = JSON.parse(xhr.response)
                                if (resp.status === 0) {
                                    console.log('consent uploaded successfully');
                                }
                            } else {
                                console.log('consent upload failed', this.status, xhr.statusText);
                            }
                            setTimeout(function () { isConsentTaken = false }, 0)
                        };
                        xhr.onerror = function () {
                            console.log('consent upload failed', this.status, xhr.statusText);
                            setTimeout(function () { isConsentTaken = false }, 0)
                        };
                        xhr.send(JSON.stringify(consentedItem));
                    }

                    var uploadConsent = function () {
                        var payload = prepareConsentPayload(form)
                        if(payload) {
                            return postConsentedItems(payload);
                        }
                    }

                    form.addEventListener('submit', function () {
                        uploadConsent()
                    })

                    if (codeGenMetadata.consentTrigger.action === 'click') {
                        var trigger = form.querySelector(codeGenMetadata.consentTrigger.selector)
                            if (trigger) {
                                trigger.addEventListener(codeGenMetadata.consentTrigger.action, function () {
                                    uploadConsent()
                                })
                            }
                        }
                    })</script>  
	</main>
 <!-- After adding this script, call setConsentBannerParams({uuid: <unique id> }) to set unique ID for a customer. -->
<script>
(function () {
	var s = document.createElement('script');
	s.src = 'https://cdn-prod.eu.securiti.ai/consent/cookie-consent-sdk.js';
	s.setAttribute('data-tenant-uuid', '7b43eaa8-fa66-4a36-a2b8-dc115c2c49ac');
	s.setAttribute('data-domain-uuid', 'd0af334e-187d-40e1-b0ce-b467a5838be0');
	s.setAttribute('data-backend-url', 'https://app.eu.securiti.ai');
	s.defer = true;
	var parent_node = document.head || document.body;
	parent_node.appendChild(s);
	s.addEventListener('load', function() { window.initCmp(); });
})()
</script>
<script
  src="https://js.hcaptcha.com/1/api.js?onload=yourFunction&render=explicit"
  async
  defer
></script>
<a href="https://www.hcaptcha.com/privacy">Privacy Policy</a>
<a href="https://www.hcaptcha.com/terms">Terms of Service</a>
<!-- You may style the button by overriding class "cmp-revoke-consent" -->
<button class="cmp-revoke-consent">To Chnage Consent</button>	
</body>

</html>
